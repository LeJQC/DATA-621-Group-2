---
title: "Data 621 - Homework 1"
author: "Shamecca Marshall"
date: "2024-02-23"
output: html_document
---


```{r}
library(tidyr)
library(tidyverse)
library(knitr)
library(kableExtra)
library(DT)
library(reshape2)
library(naniar) 
library(corrplot) 
library(e1071) 
library(caret)
library(jtools)
library(performance)
```


## Overview
  In this homework assignment, you will explore, analyze and model a data set containing approximately 2200records. Each record represents a professional baseball team from the years 1871 to 2006 inclusive. Each record
has the performance of the team for the given year, with all of the statistics adjusted to match the performance of
a 162 game season.
  Your objective is to build a multiple linear regression model on the training data to predict the number of wins
for the team. You can only use the variables given to you (or variables that you derive from the variables
provided). Below is a short description of the variables of interest in the data set:

```{r}
train <- read_csv('https://raw.githubusercontent.com/Meccamarshall/Data621/main/Homework1/moneyball-training-data.csv', col_names = TRUE)[,-1] 
eval <- read_csv('https://raw.githubusercontent.com/Meccamarshall/Data621/main/Homework1/moneyball-evaluation-data.csv',col_names=TRUE)[,-1] 

# Renaming the column names to make them less complicated
colnames(train) <- gsub("TEAM_", "", colnames(train))
colnames(eval) <- gsub("TEAM_", "", colnames(eval))
```

### Data Exploration
```{r}
summary(train)
summary(eval)
```

### Glimpse at Data
```{r}
glimpse(train)
glimpse(eval)
```

### Find the standard deviation for both datasets
```{r}
apply(train,2,sd, na.rm=TRUE)
apply(eval,2,sd, na.rm=TRUE)
```

```{r}
# Creating boxplot
ggplot(data = melt(train), aes(x=variable, y=value)) + geom_boxplot(aes(color=variable)) + coord_flip() + labs(title="BoxPlot for all variables")
```

```{r}
# Variable distributions
ggplot(melt(train), aes(x=value))+
geom_density(fill = "#ffc8dd", color="#cdb4db") + 
  facet_wrap(~variable, scales ="free", ncol = 4) +
  labs(x = element_blank(), y = element_blank())
```

### Data Preparation
```{r}
# Checking for any missing values
sapply(train, function(x) sum(is.na(x)))
```
```{r}
vis_miss(train)
```

```{r}
gg_miss_var(train)+ labs(title="Summary of Missing Data Visual")
```

```{r}
# Correlation Plot amongst the variables
train %>% cor(., use="pairwise.complete.obs", method = "pearson") %>% corrplot(.,method = "color", type= "upper", tl.col="black", diag=TRUE , number.cex = 0.5, addCoef.col = 'black', tl.srt=50, col=colorRampPalette(c("#9c89b8","#f0a6ca","#b8bedd"))(200))
```
```{r}
train %>%
  gather(variable, value, -TARGET_WINS) %>%
  ggplot(., aes(value, TARGET_WINS)) + 
  geom_point(fill = "#a9def9", color="#a9def9") + 
  geom_smooth(method = "lm", se = FALSE, color = "#7b2cbf") + 
  facet_wrap(~variable, scales ="free", ncol = 4) +
  labs(x = element_blank(), y = "Wins")+
  labs(title="Relationship Between Predictions and TARGET_WINS")
```

Since more than 90% of the data for the TEAM_BATTING_HBP is missing, the variable has been removed from both train and eval data. 

# Model Building
```{r}

```